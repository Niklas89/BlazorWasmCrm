@inject ILocalStorageService LocalStorage
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager

<SfAppBar ColorMode="AppBarColor.Primary">
    <AuthorizeView>
        <Authorized>
            <SfButton CssClass="e-inherit" IconCss="e-icons e-home" Content="Home"
                      OnClick="@(() => NavigateToPage("/"))" />
            <SfButton CssClass="e-inherit" IconCss="e-icons e-user" Content="Contacts"
                      OnClick="@(() => NavigateToPage("/contacts"))" />
            <SfButton CssClass="e-inherit" IconCss="e-icons e-location" Content="Map"
                      OnClick="@(() => NavigateToPage("/map"))" />
            <SfButton CssClass="e-inherit" IconCss="e-icons e-notes" Content="Notes"
                      OnClick="@(() => NavigateToPage("/notes"))" />
            <AppBarSpacer></AppBarSpacer>
            <SfButton CssClass="e-inherit" IconCss="e-icons e-plus"
                      Content="New Contact" OnClick="@(() => NavigateToPage("/contacts/new"))" />
            <SfButton CssClass="e-inherit" IconCss="oi oi-account-logout"
                      Content="Logout" OnClick="@(() => Logout())" />
        </Authorized>
        <NotAuthorized>
            <SfButton CssClass="e-inherit" IconCss="e-icons e-home" Content="Home"
                      OnClick="@(() => NavigateToPage("/"))" />
            <SfButton CssClass="e-inherit" IconCss="oi oi-person"
            Content="Sign up" OnClick="@(() => NavigateToPage("/register"))" />
            <SfButton CssClass="e-inherit" IconCss="oi oi-account-login"
                      Content="Login" OnClick="@(() => NavigateToPage("/login"))" />
        </NotAuthorized>
    </AuthorizeView>
</SfAppBar>

@code {
    void NavigateToPage(string page)
    {
        NavigationManager.NavigateTo(page);
    }

    private async Task Logout()
    {
        await LocalStorage.RemoveItemAsync("authToken");
        await AuthenticationStateProvider.GetAuthenticationStateAsync();
        NavigationManager.NavigateTo("");
    }
}